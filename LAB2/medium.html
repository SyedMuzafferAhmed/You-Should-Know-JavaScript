<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucky Game</title>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="./styles.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
</head>

<body>
    <section>
        <center>
            <h1>Welcome <span id="player-name"></span></h1>
            <h1>Attempts : <span id="attempts"></span></h1>
            <button type="button" class="btn btn-primary" onclick="window.location.href = './index.html'"
                id="easy">Easy</button>
            <button class="btn btn-secondary" onclick="window.location.href = './medium.html'" type="button" id="button"
                name="button">Medium</button>
            <button class="btn btn-danger" onclick="window.location.href = './hard.html'" type=" button"
                id="hard">Hard</button>
            <div>
                <table id="my-game">
                </table>
            </div>
            <button type="button" onclick="window.location.href = './leaderboard.html'" class="btn btn-success btn-lg">
                ðŸ‘‘ Leaderboard</button>
        </center>
    </section>

    <script>
        if (!localStorage.getItem("winner")) {
            localStorage.setItem("winner", JSON.stringify([]));
        }
        let username = prompt("Enter your Name: ");
        console.log(username);
        let audio = new Audio("./beep.mp3");
        document.getElementById("player-name").innerText = username;
        let attempts = 0;
        let visitedCells = [];
        document.getElementById("attempts").innerText = attempts;
        const music = new Audio("./beep.mp3");
        let clickedarray = [];




        function main() {



            let table = document.getElementById("my-game");
            let tableData = [];

            let row,
                column,
                counter = 0;
            for (let c = 1; c <= 100; c++) {
                tableData.push(c);
            }
            tableData.sort((a, b) => 0.5 - Math.random());
            for (let i = 1; i <= 10; i++) {
                row = document.createElement("tr");
                for (let j = 1; j <= 10; j++) {
                    column = document.createElement("td");
                    column.id = tableData[counter];
                    column.addEventListener("click", clickAction);
                    row.appendChild(column);
                    counter++;
                }
                table.appendChild(row);
            }
        }
        function clickAction(event) {
            //Loser Logic

            let clickedNum = event.target.id;
            let primearray = [2, 3, 5, 7];
            if (primearray.includes(+clickedNum)) {
                alert("Your Game is Over. Loser");
                return location.reload("/");
            }
            //Winner Logic
            else if (clickedNum == 1) {
                attempts++;
                return alert(`You are a Winner and you took ${attempts} to Win`);
                alert(`You are the Winner. Your attempts ${attempts}`);
                let data = { username, attempts };
                let winners = JSON.parse(localStorage.getItem("winner"));
                winners.push(data);
                localStorage.setItem("winner", JSON.stringify(winners));
                location.replace("./leaderboard.html");
            }
            //Increase Attempts
            else {
                if (clickedarray.includes(+clickedNum)) {
                    audio.play();
                    alert("Already Selected Block");
                } else {
                    for (let x = clickedNum; x <= 100; x++) {
                        if (x % clickedNum == 0) {
                            document.getElementById(x).style.backgroundColor = "#61dafb";
                            clickedarray.push(+x);
                        }
                    }
                    attempts++;
                    document.getElementById("attempts").innerText = attempts;
                }
                document.addEventListener('DOMContentLoaded', () => {
                 
                    let container = document.querySelector('#my-game')
                    // Add each row to the array
                    container.querySelectorAll('.row').forEach(el => elements.push(el))
                    // Clear the container
                    container.innerHTML = ''
                    // Sort the array from highest to lowest
                    elements.sort((a, b) => b.querySelector('.attempts').textContent - a.querySelector('.attempts').textContent)
                    // Put the elements back into the container
                    elements.forEach(e => container.appendChild(e))
                });


            }


        }
        main();




    </script>



</body>

</html>